from django import forms
from .models import Instrument


class InstrumentForm(forms.ModelForm):
    """
    Форма для создания и редактирования записей об инструментах в административном интерфейсе.

    Предоставляет интерфейс для ручного управления инструментами, включая:
    - Текстовое описание с результатами YOLO анализа
    - Загрузку изображений с аннотациями детекции
    - Указание ожидаемого количества объектов для распознавания
    - Сохранение оригинального имени файла

    Используется в Django Admin для CRUD операций с инструментами.
    """

    class Meta:
        """
        Мета-класс для конфигурации формы.

        Определяет связанную модель, отображаемые поля и их настройки
        для оптимального пользовательского опыта в административном интерфейсе.
        """

        model = Instrument
        fields = ('text', 'image', 'expected_objects', 'filename')

        widgets = {
            'text': forms.Textarea(
                attrs={
                    'rows': 4,
                    'cols': 80,
                    'placeholder': 'Введите описание инструментов и результаты анализа YOLO...',
                }
            ),
            'expected_objects': forms.NumberInput(
                attrs={'min': 1, 'max': 50, 'step': 1, 'placeholder': '11'}
            ),
            'filename': forms.TextInput(
                attrs={
                    'placeholder': 'Введите оригинальное имя файла...',
                    'maxlength': 255,
                }
            ),
        }

        help_texts = {
            'expected_objects': 'Количество предметов, которые должны быть распознаны на изображении (по умолчанию 11)',
            'filename': 'Оригинальное имя файла изображения при загрузке через API',
            'text': 'Описание инструментов с результатами анализа YOLO и мета-информацией',
            'image': 'Изображение с bounding boxes и аннотациями детекции объектов',
        }

        labels = {
            'expected_objects': 'Ожидаемое количество объектов',
            'filename': 'Исходное имя файла',
            'text': 'Текст записи',
            'image': 'Изображение инструмента',
        }
